<!-- HTML part unchanged... -->

<script>
  (function () {
    const eye = document.getElementById('eye');
    const pupil = document.getElementById('pupil');
    const upperLid = document.getElementById('upperEyelid');
    const lowerLid = document.getElementById('lowerEyelid');
    const sleepLid = document.getElementById('sleepEyelid');
    const heart = document.getElementById('heart');
    const loopVideo = document.getElementById('loopVideo');
    const videoSource = document.getElementById('videoSource');
    const omerGif = document.getElementById('omerGif');

    const now = new Date();
    const day = now.getDay();
    const hour = now.getHours();

    const isVogelDay = day === 0 || day === 1; // Sunday or Monday
    const isOmerDay = day === 4; // Thursday
    const isSleeping = hour >= 1 && hour < 13;

    if (isVogelDay) {
      videoSource.src = `vogel1.mp4?t=${Date.now()}`;
      loopVideo.classList.remove('hidden');
      loopVideo.style.visibility = 'visible';
      loopVideo.load();
      eye.classList.add('hidden');
    } else if (isOmerDay) {
      omerGif.classList.remove('hidden');
      omerGif.style.visibility = 'visible';
      eye.classList.add('hidden');
    } else if (isSleeping) {
      eye.classList.add('hidden');
      sleepLid.classList.remove('hidden');
      document.body.classList.add('showBubbles');
    } else {
      startEyeBehavior();
    }

    function startEyeBehavior() {
      if (!eye) return;
      eye.classList.remove('hidden');

      const positions = [
        { x: 0.05, y: 0.05 },
        { x: 0.75, y: 0.2 },
        { x: 0.6, y: 0.6 },
        { x: 0.3, y: 0.7 },
        { x: 0.45, y: 0.45 },
      ];
      const STEP = 8000;
      const CYCLE = positions.length * STEP;

      function moveTo(p) {
        const eyeW = eye.offsetWidth;
        const eyeH = eye.offsetHeight;
        const tx = Math.min(Math.max(0, p.x * window.innerWidth), window.innerWidth - eyeW);
        const ty = Math.min(Math.max(0, p.y * window.innerHeight), window.innerHeight - eyeH);
        eye.style.left = `${tx}px`;
        eye.style.top = `${ty}px`;

        // Pupil shifts slightly based on quadrant
        pupil.style.left = p.x > 0.5 ? '80%' : '20%';
        pupil.style.top = p.y > 0.5 ? '80%' : '20%';

        setTimeout(() => {
          pupil.style.left = '50%';
          pupil.style.top = '50%';
        }, 3000);
      }

      function tick() {
        const now = Date.now() % CYCLE;
        const idx = Math.floor(now / STEP);
        moveTo(positions[idx]);
        setTimeout(tick, STEP - (now % STEP));
      }

      function blink() {
        upperLid.classList.add('blinkUp');
        lowerLid.classList.add('blinkDown');
        setTimeout(() => {
          upperLid.classList.remove('blinkUp');
          lowerLid.classList.remove('blinkDown');
        }, 500);
        setTimeout(blink, 5000 + Math.random() * 5000);
      }

      function showHeartTemporarily() {
        const eyeBox = eye.getBoundingClientRect();
        heart.style.left = eyeBox.left + 'px';
        heart.style.top = eyeBox.top + 'px';
        heart.style.display = 'block';
        eye.style.visibility = 'hidden';

        setTimeout(() => {
          heart.style.display = 'none';
          eye.style.visibility = 'visible';
          scheduleNextHeart();
        }, 2000);
      }

      function scheduleNextHeart() {
        setTimeout(showHeartTemporarily, 10000 + Math.random() * 20000);
      }

      tick();
      blink();
      scheduleNextHeart();
    }

    // Redundant, since meta refresh already exists, but keeps the logic safe
    setInterval(() => location.reload(), 3600000);
  })();
</script>
